doctype html
html
    head
        meta(name='keywords', content='Wickham, HTML, CSS')
        meta(name='description', content='HTML and CSS Tutorial with examples')
        meta(http-equiv='content-type', content='text/html; charset=utf-8')
        meta(name='viewport', content='width=device-width, initial-scale=1, maximum-scale=1')
        link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css', integrity='sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u', crossorigin='anonymous')
        title Add new Kit
        //if ie
          style(type='text/css').
            html { scrollbar-face-color: #ccccc2; scrollbar-shadow-color: #ccccc2; scrollbar-highlight-color: #ccccc2; scrollbar-3dlight-color: #ccccc2; scrollbar-darkshadow-color: #ccccc2; scrollbar-track-color: #e9e9e2; scrollbar-arrow-color: #e9e9e2; }
        style(type='text/css', media='all').

            /* set a left margin to compensate for IE/Win always making room for a scrollbar */
            html, body {
                background-color: #eeeeee;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            /* set a left margin to compensate for IE/Win always making room for a scrollbar */
            div#middlewrap {
                width: 100%;
                padding-bottom: 50px;
                height: 100%;
            }
            /* set left margin for modern browsers */
            body>div#middlewrap {
                margin-left:0;
            }
            div#middle {
                width:100%;
                margin:0 auto;
                height: 100%
            }
            /* no positioning for IE5/Win - the whole page scrolls */
            div#footerwrap {
                width:100%;
                position:absolute;
                bottom:0;
                left:0;
                height:50px;

            }
            body>div#footerwrap {
                position:fixed;
            }
            div#footer {
                height:50px;
                width:720px;
                margin:0 auto;
            }
            #bottomNav a {
                font-size: 12pt;
                color: #ddd;
                text-decoration: none;
            }

            #bottomNav a:hover {
                color: #fff;
            }
            #bottomNav {
                background: #000;
            }

            #bottomNav > .active {
                background: #888888;
            }

            .col-centered {
                float: none;
                margin: 0 auto;
            }
        //if ie 6
          link(rel='stylesheet', href='ie6bereastreet.css', type='text/css')
    body
        #middlewrap.container
            .row
            .col-xs-12.col-s-12.col-md-12.col-lg-12.text-center
                h1 Add new Kit
            ul.bg-info.col-xs-12.col-s-12.col-md-12.col-lg-12
                    li Turn on FAirKit
                    li Connect your phone to FAirKit_xxxxxx wifi network
                    li Click search button below
            #alert.alert.col-xs-12.col-s-12.col-md-12.col-lg-12(role='alert' style='display:none')
            #content.col-xs-12.col-s-12.col-md-12.col-lg-12.row
                .col-xs-6.col-s-6.col-md-3.col-lg-3.col-centered
                    #search.btn.btn-block.btn-info Search device
                form#form.col-xs-12.col-s-12.col-md-6.col-lg-6.col-centered(style='display:none')
                    .form-group
                        label(for='device') KitID:
                        input#device.form-control(type='text' disabled=true value="")
                    .form-group
                        label(for='name') Kit Name:
                        input#name.form-control(type='text' value="")
                    .form-group
                        label(for='wifi') Wifi network available:
                            select#wifi.form-control
                    .form-group
                        label(for='pwd') Wifi password:
                        input#pwd.form-control(type='password')
                    |
                    button#config.btn.btn-success(type='submit') Config

        #footerwrap
            #footer
                .col-xs-12.navbar-inverse.navbar-fixed-bottom
                    #bottomNav.row
                        a(href='./mobile').col-xs-4.text-center
                                i.glyphicon.glyphicon-home
                                br
                                | Home
                        a(href='./list').col-xs-4.text-center
                                i.glyphicon.glyphicon-list
                                br
                                | List Kit
                        a(href='./add').col-xs-4.text-center.active
                                i.glyphicon.glyphicon-plus
                                br
                                | Add Kit
        script(src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js")
        script(src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js")
        script(src="./js/add.js")
        script.
          // A $( document ).ready() block.
          $(document).ready(function () {
            $("#form").submit(function (e) {
              e.preventDefault();
            });
            $('#search').on('click', function (){
              search();
            })
            $('#pwd').on('change', function(){
              var val = $('#pwd').val();
              if(val.length >= 8)
                $('#config').prop('disabled', false);
              else
                $('#config').prop('disabled', true);
            });
            $('#config').on('click', function(){
              $.ajax({
                url: `http://192.168.4.1/config?ssid=${$('#wifi').val()}&pwd=${$('#pwd').val()}`,
                error: function(){
                  alert({error: true, msg: "An error has occur"});
                  $('#form').hide();
                },
                success: function (result) {
                  if(result == 1){
                    alert({error: false, msg: "Config Kit successfully"});
                    $('#form').hide();
                  } else {
                    alert({error: true, msg: "An error has occur"});
                    $('#form').hide();
                  }
                }
              });
            })
          });
